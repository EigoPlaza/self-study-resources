<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>å˜èªã‚«ãƒ¼ãƒ‰AI</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 1rem; display:flex; flex-direction:column; align-items:center; }
    .controls { display: flex; flex-direction: column; gap: 1rem; width: 100%; max-width: 700px; }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }
    .row > div {
      flex: 1 1 calc(50% - 0.75rem); /* 1è¡Œã«2ã¤ä¸¦ã¹ã‚‹ */
      min-width: 200px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ç¸¦ä¸¦ã³ã«åˆ‡ã‚Šæ›¿ãˆã‚„ã™ãã™ã‚‹ */
    }
    /* ãƒˆãƒ”ãƒƒã‚¯æŒ‡å®šã®å…¥åŠ›æ¬„ã ã‘å¹…ã‚’èª¿æ•´ */
    #topicInput {
      max-width: 320px; /* æ¨ªå¹…ã‚’æŠ‘ãˆã‚‹ */
    }
    #wordCount {
      max-width: 100px; /* å¿…è¦æœ€å°é™ã®ã‚µã‚¤ã‚ºã« */
    }
    label { font-weight:bold; font-size:0.9rem; margin-bottom:0.2rem; display:block; }
    select, input, button { width:100%; padding:0.5rem; font-size:1rem; border-radius:8px; border:1px solid #ccc; }
    #generateBtn { background-color:#007bff; color:white; font-weight:bold; border:none; font-size:1rem; padding:0.6rem 1.2rem; border-radius:8px; }
    #generateBtn:hover { background-color:#0056b3; }
    
    #flashcardContainer {
      perspective: 1000px;
      width: 90%;
      max-width: 400px;
      height: 250px;
      margin: 2rem auto; /* ä¸Šä¸‹ã«ä½™ç™½ã‚’åºƒã’ã‚‹ */
    }
    .center-message {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      height: 100%;
      font-size: 1.2rem;
    }
    .card-inner { position:relative; width:100%; height:100%; transition:transform 0.6s; transform-style:preserve-3d; cursor:pointer; }
    .flipped { transform:rotateY(180deg); }
    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: block; /* â† ã“ã“ã‚’å¤‰æ›´ï¼ˆflexã‚’ã‚„ã‚ã‚‹ï¼‰ */
      border: 1px solid #333;
      border-radius: 12px;
      padding: 1rem;
      text-align: left; /* â† æ¨ªæ›¸ãã§è‡ªç„¶ã« */
      font-size: 1.5rem;
    }
    .front-center {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      height: 100%;
      font-size: 2rem; /* è¡¨ã®å˜èªã¯å¤§ããè¦‹ã›ã‚‹ */
      font-weight: bold;
    }
    .card-front { background:#fff; }
    .card-back { background:#fafafa; transform:rotateY(180deg); }
    .nav {
      display: flex;
      gap: 1rem;
      align-items: center;
      margin-top: 1.5rem; /* ã‚«ãƒ¼ãƒ‰ã¨ã®é–“éš”ã‚’åºƒã’ã‚‹ */
    }
    #cardCounter {
      min-width: 50px; /* å›ºå®šå¹…ã‚’è¨­å®šã—ã¦ã€æ¨ªä¸¦ã³ã‚’ç¶­æŒ */
      text-align: center;
    }
    .nav button { padding:0.5rem 1rem; }
    .audio-btn {
      width: auto;
      padding: 0.3rem 0.4rem;
      font-size: 1.2rem;
      border: none;
      background: transparent;
      cursor: pointer;
    }
    .audio-btn:hover {
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <div class="controls">
    <div class="row">
      <div>
        <label for="levelSelect">ğŸ”¤ ãƒ¬ãƒ™ãƒ«</label>
        <select id="levelSelect">
          <option value="A1">A1ï¼ˆè¶…åˆç´šï¼‰</option>
          <option value="A2">A2ï¼ˆåˆç´šï¼‰</option>
          <option value="B1">B1ï¼ˆä¸­ç´šï¼‰</option>
          <option value="B2">B2ï¼ˆä¸­ä¸Šç´šï¼‰</option>
          <option value="C1">C1ï¼ˆä¸Šç´šï¼‰</option>
          <option value="C2">C2ï¼ˆæœ€ä¸Šç´šï¼ãƒã‚¤ãƒ†ã‚£ãƒ–ç´šï¼‰</option>
        </select>
      </div>
      <div>
        <label for="topicSelect">ğŸ—‚ï¸ ãƒˆãƒ”ãƒƒã‚¯</label>
        <select id="topicSelect">
          <option value="Travel">æ—…è¡Œ</option>
          <option value="Food">é£Ÿã¹ç‰©ãƒ»ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³</option>
          <option value="Business">ãƒ“ã‚¸ãƒã‚¹</option>
          <option value="Health">å¥åº·</option>
          <option value="Shopping">è²·ã„ç‰©</option>
          <option value="Weather">å¤©æ°—</option>
        </select>
      </div>
      <div>
        <label for="topicInput">âœï¸ ãƒˆãƒ”ãƒƒã‚¯æŒ‡å®šï¼ˆä»»æ„ï¼‰</label>
        <input id="topicInput" type="text" placeholder="ä¾‹ï¼šç©ºæ¸¯ã€ãƒãƒ¯ã‚¤" />
      </div>
      <div>
        <label for="wordCount">ğŸ“¦ å˜èªæ•°</label>
        <input id="wordCount" type="number" min="5" max="20" value="10" />
      </div>
    </div>
    <button id="generateBtn">å˜èªã‚«ãƒ¼ãƒ‰ç”Ÿæˆï¼</button>
    <div id="loadingMessage" style="text-align:center; font-weight:bold; color:#007bff; display:none;">ğŸ”„ ç”Ÿæˆä¸­ã§ã™...</div>
  </div>

  <div id="flashcardContainer">
    <div id="cardInner" class="card-inner">
      <div class="card-face card-front" id="cardFront">ğŸ‘‰ æ¡ä»¶ã‚’é¸ã‚“ã§ã€å˜èªã‚«ãƒ¼ãƒ‰ç”Ÿæˆï¼ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
      <div class="card-face card-back" id="cardBack">æ—¥æœ¬èªè¨³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
    </div>
  </div>
  <div class="nav">
    <button id="prevBtn">Prev</button>
    <span id="cardCounter">0 / 0</span>
    <button id="nextBtn">Next</button>
  </div>

  <script>
    let cards = [];
    let current = 0;
    const cardInner = document.getElementById('cardInner');
    const cardFront = document.getElementById('cardFront');
    const cardBack = document.getElementById('cardBack');
    const cardCounter = document.getElementById('cardCounter');

    function renderCard() {
      if (cards.length === 0) {
        cardFront.innerHTML = `<div class="center-message">ğŸ‘‰ æ¡ä»¶ã‚’é¸ã‚“ã§ã€å˜èªã‚«ãƒ¼ãƒ‰ç”Ÿæˆï¼ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>`;
        cardBack.innerHTML = `<div class="center-message">æ—¥æœ¬èªè¨³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>`;
        cardCounter.textContent = "0 / 0";
        cardInner.classList.remove('flipped');
        return;
      }
    
      const card = cards[current];
    
      // è¡¨ï¼šå˜èªï¼‹éŸ³å£°ãƒœã‚¿ãƒ³
      cardFront.innerHTML = `
        <div class="front-center">
          ${card.en}
          <button onclick="speak('${card.en}')" style="margin-left:10px;">ğŸ”Š</button>
        </div>
      `;
    
      // è£ï¼šæ—¥æœ¬èªï¼‹è‹±æ–‡ï¼‹éŸ³å£°ãƒœã‚¿ãƒ³
      cardBack.innerHTML = `
        <div style="font-size:1.8rem; font-weight:bold; margin-bottom:1rem;">
          ${card.ja}
        </div>
        <div style="font-size:1.2rem; color:#333; margin-bottom:0.8rem;">
          ${card.example_en || ''} 
          ${card.example_en ? `<button class="audio-btn" onclick="event.stopPropagation(); speak('${card.en}')">ğŸ”Š</button>` : ''}
        </div>
        <div style="font-size:1.1rem; color:#555;">
          ${card.example_ja || ''}
        </div>
      `;
    
      cardCounter.textContent = `${current + 1} / ${cards.length}`;
      cardInner.classList.remove('flipped');
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US'; // è‹±èªç™ºéŸ³
      utterance.rate = 0.9; // å°‘ã—ã‚†ã£ãã‚Š
      speechSynthesis.speak(utterance);
    }

    function changeCard(newIndex) {
      // ã¾ãšãƒ•ãƒªãƒƒãƒ—è§£é™¤ï¼ˆæ­£é¢ã«æˆ»ã™ï¼‰
      cardInner.classList.remove('flipped');
    
      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«å†…å®¹æ›´æ–°
      setTimeout(() => {
        current = newIndex;
        renderCard(); // æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚»ãƒƒãƒˆ
      }, 600); // flipã®0.6sã«åˆã‚ã›ã‚‹
    }
    
    document.getElementById('nextBtn').addEventListener('click', () => {
      const nextIndex = (current < cards.length - 1) ? current + 1 : 0;
      changeCard(nextIndex);
    });
    
    document.getElementById('prevBtn').addEventListener('click', () => {
      const prevIndex = (current > 0) ? current - 1 : cards.length - 1;
      changeCard(prevIndex);
    });

    
    cardInner.addEventListener('click', () => {
      cardInner.classList.toggle('flipped');
    });

    document.getElementById('generateBtn').addEventListener('click', async () => {
      const level = document.getElementById('levelSelect').value;
      const topicSelectValue = document.getElementById('topicSelect').value;
      const topicInputValue = document.getElementById('topicInput').value.trim();
      const topic = topicInputValue !== "" ? topicInputValue : topicSelectValue;
      const count = document.getElementById('wordCount').value;
      const loadingMsg = document.getElementById('loadingMessage');
      loadingMsg.style.display = 'block';
      try {
        const res = await fetch('https://vocab-ai.eigoplaza.workers.dev', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ level, topic, count })
        });
        if (res.ok) {
          cards = await res.json(); // [{en:"airport",ja:"ç©ºæ¸¯"}...]
          current = 0;
          renderCard();
        } else {
          alert('ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (e) {
        alert('ã‚¨ãƒ©ãƒ¼ï¼š' + e.message);
      } finally {
        loadingMsg.style.display = 'none';
      }
    });
    renderCard();
  </script>
</body>
</html>
