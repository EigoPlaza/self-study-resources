<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç¬é–“è‹±ä½œæ–‡ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: Arial, sans-serif; margin: 0; padding: 1rem; display:flex; flex-direction:column; align-items:center; }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: flex-end;
      justify-content: flex-start;
    }
    
    .controls > div {
      display: flex;
      flex-direction: column;
      min-width: 120px;
      flex: 1 1 150px; /* å¹…ã«ä½™è£•ãŒãªã„ã¨ãã¯æŠ˜ã‚Šè¿”ã™ */
    }
    
    .controls select, .controls input, .controls button {
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .controls button {
      background-color: #f0f0f0;
      border: 1px solid #999;
    }
    .controls label {
      font-weight: bold;
      font-size: 0.9rem;
      margin-bottom: 0.2rem;
      display: block;
    }
    
    .controls button:hover {
      background-color: #e0e0e0;
    }

    #generateBtn {
      background-color: #007bff;
      color: white;
      font-weight: bold;
      border: none;
    }
    
    #generateBtn:hover {
      background-color: #0056b3;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }
    
    /* Collapsible structure list */
    #structureList { width:100%; max-width:600px; margin-top:0.5rem; border:1px solid #ccc; border-radius:8px; padding:0.5rem; display:none; }
    #structureList ul { list-style:none; margin:0; padding:0; }
    #structureList li { padding:0.25rem 0; cursor:pointer; }
    #structureList li:hover { background:#f0f0f0; }

    /* Flashcard styles */
    #flashcardContainer { perspective: 1000px; width: 90%; max-width: 400px; height: 250px; margin-bottom:1rem; }
    .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; cursor:pointer; }
    .flipped { transform: rotateY(180deg); }
    .card-face { position: absolute; width:100%; height:100%; backface-visibility:hidden; display:flex; align-items:center; justify-content:center; border:1px solid #333; border-radius:12px; padding:1rem; text-align:center; font-size:1.25rem; }
    .card-front { background:#fff; }
    .card-back { background:#fafafa; transform: rotateY(180deg); }

    .nav { display:flex; gap:1rem; align-items:center; }
    .nav button { padding:0.5rem 1rem; font-size:1rem; cursor:pointer; }
  </style>
</head>
<body>
  <div class="controls">
    <!-- èªå½™ãƒ¬ãƒ™ãƒ« -->
    <div>
      <label for="levelSelect">ğŸ”¤ èªå½™ãƒ¬ãƒ™ãƒ«</label>
      <select id="levelSelect">
        <option value="A1">A1ï¼ˆåˆç´šï¼‰</option>
        <option value="A2">A2ï¼ˆåˆä¸­ç´šï¼‰</option>
        <option value="B1">B1ï¼ˆä¸­ç´šï¼‰</option>
        <option value="B2">B2ï¼ˆä¸­ä¸Šç´šï¼‰</option>
        <option value="C1">C1ï¼ˆä¸Šç´šï¼‰</option>
      </select>
    </div>

    <!-- æ–‡æ³•é …ç›® -->
    <div>
      <label for="grammarSelect">ğŸ§  æ–‡æ³•é …ç›®</label>
      <select id="grammarSelect">
        <optgroup label="ä¸­1">
          <option value="beå‹•è©">beå‹•è©</option>
          <option value="ä¸€èˆ¬å‹•è©">ä¸€èˆ¬å‹•è©</option>
          <option value="å‘½ä»¤æ–‡">å‘½ä»¤æ–‡</option>
          <option value="Let's">Let's</option>
          <option value="ç–‘å•è©ï¼ˆwhat, who, where, when, etcï¼‰">ç–‘å•è©ï¼ˆwhat, who, where, when, etcï¼‰</option>
          <option value="ä»£åè©ï¼ˆä¸»æ ¼ãƒ»æ‰€æœ‰æ ¼ãƒ»ç›®çš„æ ¼ï¼‰">ä»£åè©ï¼ˆä¸»æ ¼ãƒ»æ‰€æœ‰æ ¼ãƒ»ç›®çš„æ ¼ï¼‰</option>
          <option value="ä¸‰äººç§°å˜æ•°ç¾åœ¨">ä¸‰äººç§°å˜æ•°ç¾åœ¨</option>
          <option value="canï¼ˆå¯èƒ½ï¼‰">canï¼ˆå¯èƒ½ï¼‰</option>
          <option value="ç¾åœ¨é€²è¡Œå½¢">ç¾åœ¨é€²è¡Œå½¢</option>
          <option value="there is / there are">there is / there are</option>
        </optgroup>
      
        <optgroup label="ä¸­2">
          <option value="éå»å½¢">éå»å½¢</option>
          <option value="éå»é€²è¡Œå½¢">éå»é€²è¡Œå½¢</option>
          <option value="æœªæ¥è¡¨ç¾ï¼ˆwill / be going toï¼‰">æœªæ¥è¡¨ç¾ï¼ˆwill / be going toï¼‰</option>
          <option value="åŠ©å‹•è©ï¼ˆmust, have to, should, etcï¼‰">åŠ©å‹•è©ï¼ˆmust, have to, should, etcï¼‰</option>
          <option value="ä¸å®šè©ï¼ˆåè©çš„ãƒ»å½¢å®¹è©çš„ãƒ»å‰¯è©çš„ç”¨æ³•ï¼‰">ä¸å®šè©ï¼ˆåè©çš„ãƒ»å½¢å®¹è©çš„ãƒ»å‰¯è©çš„ç”¨æ³•ï¼‰</option>
          <option value="å‹•åè©">å‹•åè©</option>
          <option value="æ¯”è¼ƒï¼ˆåŸç´šãƒ»æ¯”è¼ƒç´šãƒ»æœ€ä¸Šç´šï¼‰">æ¯”è¼ƒï¼ˆåŸç´šãƒ»æ¯”è¼ƒç´šãƒ»æœ€ä¸Šç´šï¼‰</option>
          <option value="so ... that / too ... to">so ... that / too ... to</option>
          <option value="æ¥ç¶šè©ï¼ˆwhen, if, because, etcï¼‰">æ¥ç¶šè©ï¼ˆwhen, if, because, etcï¼‰</option>
        </optgroup>
      
        <optgroup label="ä¸­3">
          <option value="å—å‹•æ…‹">å—å‹•æ…‹</option>
          <option value="ç¾åœ¨å®Œäº†ï¼ˆçµŒé¨“ãƒ»å®Œäº†ãƒ»ç¶™ç¶šï¼‰">ç¾åœ¨å®Œäº†ï¼ˆçµŒé¨“ãƒ»å®Œäº†ãƒ»ç¶™ç¶šï¼‰</option>
          <option value="é–¢ä¿‚ä»£åè©ï¼ˆä¸»æ ¼ãƒ»ç›®çš„æ ¼ï¼‰">é–¢ä¿‚ä»£åè©ï¼ˆä¸»æ ¼ãƒ»ç›®çš„æ ¼ï¼‰</option>
          <option value="é–¢ä¿‚å‰¯è©ï¼ˆwhen / whereï¼‰">é–¢ä¿‚å‰¯è©ï¼ˆwhen / whereï¼‰</option>
          <option value="åè©ç¯€ï¼ˆthat / if / whetherï¼‰">åè©ç¯€ï¼ˆthat / if / whetherï¼‰</option>
          <option value="åˆ†è©ï¼ˆç¾åœ¨åˆ†è©ãƒ»éå»åˆ†è©ï¼‰">åˆ†è©ï¼ˆç¾åœ¨åˆ†è©ãƒ»éå»åˆ†è©ï¼‰</option>
          <option value="SVOOãƒ»SVOCæ§‹æ–‡">SVOOãƒ»SVOCæ§‹æ–‡</option>
        </optgroup>
      
        <optgroup label="é«˜æ ¡ä»¥ä¸Š">
          <option value="be supposed to">be supposed to</option>
          <option value="have something done">have something done</option>
          <option value="used to / be used to">used to / be used to</option>
          <option value="ä»®å®šæ³•ï¼ˆç¾åœ¨ãƒ»éå»ï¼‰">ä»®å®šæ³•ï¼ˆç¾åœ¨ãƒ»éå»ï¼‰</option>
          <option value="wishæ§‹æ–‡">wishæ§‹æ–‡</option>
          <option value="åŸå½¢ä¸å®šè©ï¼ˆmake / let / haveï¼‰">åŸå½¢ä¸å®šè©ï¼ˆmake / let / haveï¼‰</option>
          <option value="å½¢å¼ä¸»èª / å½¢å¼ç›®çš„èª">å½¢å¼ä¸»èª / å½¢å¼ç›®çš„èª</option>
          <option value="ç„¡ç”Ÿç‰©ä¸»èªæ§‹æ–‡">ç„¡ç”Ÿç‰©ä¸»èªæ§‹æ–‡</option>
          <option value="åˆ†è©æ§‹æ–‡">åˆ†è©æ§‹æ–‡</option>
          <option value="å¼·èª¿æ§‹æ–‡ï¼ˆIt is ã€œ that ã€œï¼‰">å¼·èª¿æ§‹æ–‡ï¼ˆIt is ã€œ that ã€œï¼‰</option>
          <option value="å€’ç½® / æŒ¿å…¥">å€’ç½® / æŒ¿å…¥</option>
        </optgroup>
      </select>
    </div>

    <!-- ãƒˆãƒ”ãƒƒã‚¯ -->
    <div>
      <label for="topicSelect">ğŸ—‚ï¸ ãƒˆãƒ”ãƒƒã‚¯</label>
      <select id="topicSelect">
        <option value="æ—¥å¸¸ç”Ÿæ´»">æ—¥å¸¸ç”Ÿæ´»</option>
        <option value="è²·ã„ç‰©">è²·ã„ç‰©</option>
        <option value="æ—…è¡Œ">æ—…è¡Œ</option>
        <option value="å­¦æ ¡">å­¦æ ¡</option>
        <option value="ä»•äº‹">ä»•äº‹</option>
      </select>
    </div>
    
    <!-- ç‰¹å®šæ§‹æ–‡ -->
    <div>
      <label for="structureInput">âœï¸ ç‰¹å®šæ§‹æ–‡ï¼ˆä»»æ„ï¼‰</label>
      <input id="structureInput" placeholder="æ§‹æ–‡ (ä»»æ„)" />
    </div>
    
    <!-- ãƒœã‚¿ãƒ³é¡ï¼ˆé †ç•ªå…¥ã‚Œæ›¿ãˆæ¸ˆã¿ï¼‰ -->
    <div>
      <button id="toggleListBtn">ä¸­ç´šæ§‹æ–‡ãƒªã‚¹ãƒˆ</button>
    </div>
    <div>
      <button id="generateBtn">ç¬é–“è‹±ä½œæ–‡ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
    </div>
  </div>

  <div id="structureList">
    <strong>ä¸­ç´šæ§‹æ–‡ãƒªã‚¹ãƒˆ</strong>
    <ul>
      <li data-structure="be supposed to">be supposed to</li>
      <li data-structure="have something done">have something done</li>
      <li data-structure="used to / be used to">used to / be used to</li>
      <li data-structure="wish + éå»å½¢/éå»å®Œäº†">wish + éå»å½¢/éå»å®Œäº†</li>
      <li data-structure="ä»®å®šæ³•">ä»®å®šæ³•</li>
      <li data-structure="é–¢ä¿‚ä»£åè©ã®çœç•¥">é–¢ä¿‚ä»£åè©ã®çœç•¥</li>
    </ul>
  </div>

  <div id="flashcardContainer">
    <div id="cardInner" class="card-inner">
      <div class="card-face card-front" id="cardFront">ã“ã“ã«æ—¥æœ¬èªæ–‡ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
      <div class="card-face card-back" id="cardBack">English sentence appears here</div>
    </div>
  </div>
  <div class="nav">
    <button id="prevBtn">Prev</button>
    <span id="cardCounter">0 / 0</span>
    <button id="nextBtn">Next</button>
  </div>

  <script>
    // Dummy data (initial)
    const dummyCards = [
      { jp: 'ç§ã¯æ˜¨æ—¥å®¿é¡Œã‚’ã—ãŸã€‚', en: 'I did my homework yesterday.' },
      { jp: 'å½¼ã¯ä»Šã‚µãƒƒã‚«ãƒ¼ã‚’ã—ã¦ã„ã‚‹ã€‚', en: 'He is playing soccer now.' },
      { jp: 'ã‚ãªãŸã¯çŒ«ãŒå¥½ãã§ã™ã‹ï¼Ÿ', en: 'Do you like cats?' },
      { jp: 'ç§ã¯æ±äº¬ã«è¡Œã£ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚', en: 'I have been to Tokyo.' },
      { jp: 'æ˜æ—¥é›¨ãŒé™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚', en: 'It may rain tomorrow.' },
      { jp: 'ç§ã¯éŸ³æ¥½ã‚’è´ãã®ãŒå¥½ãã§ã™ã€‚', en: 'I like listening to music.' },
      { jp: 'è‹±èªã‚’è©±ã™ã“ã¨ã¯æ¥½ã—ã„ã€‚', en: 'Speaking English is fun.' },
      { jp: 'å½¼å¥³ã¯æ˜¨æ—¥ãƒ†ãƒ¬ãƒ“ã‚’è¦‹ãªã‹ã£ãŸã€‚', en: 'She didn\'t watch TV yesterday.' }
    ];

    let cards = [...dummyCards];
    let current = 0;

    const cardInner = document.getElementById('cardInner');
    const cardFront = document.getElementById('cardFront');
    const cardBack = document.getElementById('cardBack');
    const cardCounter = document.getElementById('cardCounter');

    function renderCard() {
      cardFront.textContent = cards[current].jp;
      cardBack.textContent = cards[current].en;
      cardCounter.textContent = `${current + 1} / ${cards.length}`;
      cardInner.classList.remove('flipped');
    }

    // Navigation
    document.getElementById('nextBtn').addEventListener('click', () => {
      if (current < cards.length - 1) current++; else current = 0;
      renderCard();
    });
    document.getElementById('prevBtn').addEventListener('click', () => {
      if (current > 0) current--; else current = cards.length - 1;
      renderCard();
    });

    // Flip on click/tap
    cardInner.addEventListener('click', () => {
      cardInner.classList.toggle('flipped');
    });

    // Swipe support
    let startX = null;
    cardInner.addEventListener('touchstart', e => {
      startX = e.touches[0].clientX;
    });
    cardInner.addEventListener('touchend', e => {
      if (startX === null) return;
      let endX = e.changedTouches[0].clientX;
      let diff = startX - endX;
      if (Math.abs(diff) > 30) {
        if (diff > 0) { // swipe left
          document.getElementById('nextBtn').click();
        } else {
          document.getElementById('prevBtn').click();
        }
      }
      startX = null;
    });

    // Toggle structure list
    document.getElementById('toggleListBtn').addEventListener('click', () => {
      const list = document.getElementById('structureList');
      list.style.display = list.style.display === 'none' || list.style.display === '' ? 'block' : 'none';
    });

    // Click on structure to fill input
    document.querySelectorAll('#structureList li').forEach(li => {
      li.addEventListener('click', () => {
        document.getElementById('structureInput').value = li.dataset.structure;
        document.getElementById('structureList').style.display = 'none';
      });
    });

    // Generate button (currently loads dummy cards)
    document.getElementById('generateBtn').addEventListener('click', async () => {
      // TODO: Integrate with OpenAI via Cloudflare variables
      // For now, use dummy set and shuffle slightly
      cards = [...dummyCards].sort(() => Math.random() - 0.5);
      current = 0;
      renderCard();
    });

    // Initial render
    renderCard();
  </script>
</body>
</html>
